// weconnect-server/prisma/schema/personProcess.prisma, parallel to /models/PersonProcess.js

/// An ordered series of steps to accomplish an onboarding goal
model PersonProcess {
  id                      Int     @id @default(autoincrement())
  processName             String
  description             String
  isForTeam               Boolean /// To be completed based on team(s) the volunteer is in
  // TODO: How do we set up lists?
  necessaryPriorProcessId Int /// Requires these other processes are completed first
  statusActive            Boolean /// This is a process that is in use
  // TODO: How do we set up as lists?
  teamId                  Int /// Is a process used for team(s)
}

/// One step in a PersonProcess
model PersonProcessStep {
  id                          Int     @id @default(autoincrement())
  actionUrl                   String /// Where HR team goes to do this step
  description                 String
  googleDriveFolderId         String
  infoUrl                     String /// Documentation for this step
  isGoogleDrivePermissionStep Boolean
  // TODO: How do we set up lists?
  necessaryPriorStepId        Int /// Requires that these other steps are completed first
  order                       Int /// What step is this in the process
  processId                   Int /// Id of the process this step is a part of
  stepName                    String
}

/// The status of one step in an onboarding process, for one person
model PersonProcessStepStatus {
  id Int @id @default(autoincrement())

  dateLastUpdated       DateTime @updatedAt
  doneByPersonId        Int /// The HR team member triggering the completion of the step
  googleDriveSuccess    Boolean // TODO: Can we do null, true or false?
  personId              Int /// Id of the person being taking through this process
  statusDone            Boolean
  statusError           Boolean
  statusErrorResolved   Boolean /// If there was an issue, it has been resolved
  statusResolvedComment String
  statusToDo            Boolean
}

///
model PersonProcessStepChangeLog {
  id Int @id @default(autoincrement())

  dateCreated     DateTime @default(now())
  dateLastUpdated DateTime @updatedAt
  doneByPersonId  Int /// The HR team member triggering the completion of the step
  personId        Int /// Id of the person this log entry is related to
  status          String
  statusDone      Boolean
  statusToDo      Boolean
  stepStatusId    Int /// PersonProcessStepStatus this is related to
}
